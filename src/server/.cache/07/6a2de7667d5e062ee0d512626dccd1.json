{"id":"iSF7","dependencies":[{"name":"C:\\xampp\\htdocs\\pet\\src\\server\\.babelrc","includedInParent":true,"mtime":1607404923905},{"name":"C:\\xampp\\htdocs\\pet\\src\\server\\package.json","includedInParent":true,"mtime":1607412288975},{"name":"./../lib/MidoDb","loc":{"line":1,"column":23},"parent":"C:\\xampp\\htdocs\\pet\\src\\server\\routes\\register.js","resolved":"C:\\xampp\\htdocs\\pet\\src\\server\\lib\\MidoDb.js"},{"name":"./../lib/Crypto","loc":{"line":2,"column":23},"parent":"C:\\xampp\\htdocs\\pet\\src\\server\\routes\\register.js","resolved":"C:\\xampp\\htdocs\\pet\\src\\server\\lib\\Crypto.js"},{"name":"./../lib/Utils","loc":{"line":3,"column":22},"parent":"C:\\xampp\\htdocs\\pet\\src\\server\\routes\\register.js","resolved":"C:\\xampp\\htdocs\\pet\\src\\server\\lib\\Utils.js"}],"generated":{"js":"function e(e,n,r,s,t,o,i){try{var a=e[o](i),u=a.value}catch(c){return void r(c)}a.done?n(u):Promise.resolve(u).then(s,t)}function n(n){return function(){var r=this,s=arguments;return new Promise(function(t,o){var i=n.apply(r,s);function a(n){e(i,t,o,a,u,\"next\",n)}function u(n){e(i,t,o,a,u,\"throw\",n)}a(void 0)})}}var r=require(\"./../lib/MidoDb\"),s=require(\"./../lib/Crypto\"),t=require(\"./../lib/Utils\");module.exports=function(){var e=n(regeneratorRuntime.mark(function e(n,o,i){var a,u,c,l,d,f,m=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=m.length>3&&void 0!==m[3]?m[3]:\"users\",(u=n.query)&&u.user&&u.password&&u.email&&u[\"password-confirm\"]){e.next=4;break}return e.abrupt(\"return\",o.send(t.buildResponse(!1,\"invalid params\")));case 4:if(c=u.user,l=s.md5(u.password),d=s.md5(u[\"password-confirm\"]),f=u.email.toString(),l===d){e.next=11;break}return\"Password mismatch\",e.abrupt(\"return\",o.send(t.buildResponse(!1,\"Password mismatch\")));case 11:if(-1!==f.indexOf(\"@\")&&-1!==f.indexOf(\".\")){e.next=14;break}return\"Invalid email address\",e.abrupt(\"return\",o.send(t.buildResponse(!1,\"Invalid email address\")));case 14:!1,r.init(\"mongodb\").then(function(e){var n={user:c,email:f,password:l};r.selectRecord(a,n).then(function(e){if(console.log(e),e.length&&e.length>=0){console.log(\"user found\");return r.closeDb(),o.send(t.buildResponse(!1,\"User already exist. Please use another email address or username\"))}r.init(\"mongodb\").then(function(e){var n={user:c,email:f,password:l,status:1};r.insertRecord(n,a).then(function(e){if(1!==e.ok){return r.closeDb(),o.send(t.buildResponse(!1,\"Could not complete registration. Please try again\"))}return r.closeDb(),o.send(t.buildResponse(!0,\"Account created. Please wait...\",c,f,e))}).catch(function(e){return console.log(e.message)})}).catch(function(e){return console.log(e.message)})}).catch(function(e){return console.log(e.message)})}).catch(function(e){return console.log(e)});case 16:case\"end\":return e.stop()}},e)}));return function(n,r,s){return e.apply(this,arguments)}}();"},"sourceMaps":{"js":{"mappings":[{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":0}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":9}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":11}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":13}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":15}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":17}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":19}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":21}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":23}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":26}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":30}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":34}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":36}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":38}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":41}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":44}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":46}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":48}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":54}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":60}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":63}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":75}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":77}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":80}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":82}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":87}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":89}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":92}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":100}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":108}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":111}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":116}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":118}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":121}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":130}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":132}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":135}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":142}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":153}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":157}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":159}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":164}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":166}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":176}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":183}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":187}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":195}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":204}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":206}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":209}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":213}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":215}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":217}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":223}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":225}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":228}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":237}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":239}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":242}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":244}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":246}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":248}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":250}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":252}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":254}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":261}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":264}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":273}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":275}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":278}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":280}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":282}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":284}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":286}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":288}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":290}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":298}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":301}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":308}},{"source":"../routes/register.js","original":{"line":1,"column":0},"generated":{"line":1,"column":314}},{"source":"../routes/register.js","name":"MidoDb","original":{"line":1,"column":6},"generated":{"line":1,"column":318}},{"source":"../routes/register.js","name":"require","original":{"line":1,"column":15},"generated":{"line":1,"column":320}},{"source":"../routes/register.js","original":{"line":1,"column":23},"generated":{"line":1,"column":328}},{"source":"../routes/register.js","name":"Crypto","original":{"line":2,"column":6},"generated":{"line":1,"column":347}},{"source":"../routes/register.js","name":"require","original":{"line":2,"column":15},"generated":{"line":1,"column":349}},{"source":"../routes/register.js","original":{"line":2,"column":23},"generated":{"line":1,"column":357}},{"source":"../routes/register.js","name":"Utils","original":{"line":3,"column":6},"generated":{"line":1,"column":376}},{"source":"../routes/register.js","name":"require","original":{"line":3,"column":14},"generated":{"line":1,"column":378}},{"source":"../routes/register.js","original":{"line":3,"column":22},"generated":{"line":1,"column":386}},{"source":"../routes/register.js","name":"module","original":{"line":5,"column":0},"generated":{"line":1,"column":404}},{"source":"../routes/register.js","name":"exports","original":{"line":5,"column":7},"generated":{"line":1,"column":411}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":419}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":430}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":434}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":436}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":438}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":457}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":462}},{"source":"../routes/register.js","name":"req","original":{"line":5,"column":24},"generated":{"line":1,"column":471}},{"source":"../routes/register.js","name":"req","original":{"line":5,"column":24},"generated":{"line":1,"column":473}},{"source":"../routes/register.js","name":"res","original":{"line":5,"column":29},"generated":{"line":1,"column":475}},{"source":"../routes/register.js","name":"next","original":{"line":5,"column":34},"generated":{"line":1,"column":477}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":480}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":484}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":486}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":488}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":490}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":492}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":494}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":496}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":498}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":508}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":515}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":534}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":539}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":548}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":551}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":558}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":565}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":567}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":572}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":574}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":580}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":585}},{"source":"../routes/register.js","original":{"line":9,"column":8},"generated":{"line":1,"column":587}},{"source":"../routes/register.js","name":"baseTable","original":{"line":5,"column":40},"generated":{"line":1,"column":590}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":592}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":594}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":601}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":609}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":613}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":615}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":618}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":620}},{"source":"../routes/register.js","original":{"line":5,"column":52},"generated":{"line":1,"column":623}},{"source":"../routes/register.js","name":"data","original":{"line":7,"column":10},"generated":{"line":1,"column":632}},{"source":"../routes/register.js","name":"req","original":{"line":7,"column":17},"generated":{"line":1,"column":634}},{"source":"../routes/register.js","name":"query","original":{"line":7,"column":21},"generated":{"line":1,"column":636}},{"source":"../routes/register.js","name":"data","original":{"line":9,"column":18},"generated":{"line":1,"column":644}},{"source":"../routes/register.js","name":"user","original":{"line":9,"column":23},"generated":{"line":1,"column":646}},{"source":"../routes/register.js","name":"data","original":{"line":9,"column":32},"generated":{"line":1,"column":652}},{"source":"../routes/register.js","name":"password","original":{"line":9,"column":37},"generated":{"line":1,"column":654}},{"source":"../routes/register.js","name":"data","original":{"line":9,"column":50},"generated":{"line":1,"column":664}},{"source":"../routes/register.js","name":"email","original":{"line":9,"column":55},"generated":{"line":1,"column":666}},{"source":"../routes/register.js","name":"data","original":{"line":9,"column":65},"generated":{"line":1,"column":673}},{"source":"../routes/register.js","original":{"line":9,"column":70},"generated":{"line":1,"column":675}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":695}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":696}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":698}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":703}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":705}},{"source":"../routes/register.js","name":"res","original":{"line":10,"column":15},"generated":{"line":1,"column":711}},{"source":"../routes/register.js","name":"res","original":{"line":10,"column":15},"generated":{"line":1,"column":718}},{"source":"../routes/register.js","name":"res","original":{"line":10,"column":15},"generated":{"line":1,"column":720}},{"source":"../routes/register.js","name":"res","original":{"line":10,"column":15},"generated":{"line":1,"column":727}},{"source":"../routes/register.js","name":"res","original":{"line":10,"column":15},"generated":{"line":1,"column":736}},{"source":"../routes/register.js","name":"send","original":{"line":10,"column":19},"generated":{"line":1,"column":738}},{"source":"../routes/register.js","name":"Utils","original":{"line":10,"column":24},"generated":{"line":1,"column":743}},{"source":"../routes/register.js","name":"buildResponse","original":{"line":10,"column":30},"generated":{"line":1,"column":745}},{"source":"../routes/register.js","original":{"line":10,"column":44},"generated":{"line":1,"column":760}},{"source":"../routes/register.js","original":{"line":10,"column":51},"generated":{"line":1,"column":762}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":782}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":787}},{"source":"../routes/register.js","name":"password","original":{"line":17,"column":8},"generated":{"line":1,"column":789}},{"source":"../routes/register.js","name":"user","original":{"line":12,"column":10},"generated":{"line":1,"column":792}},{"source":"../routes/register.js","name":"data","original":{"line":12,"column":17},"generated":{"line":1,"column":794}},{"source":"../routes/register.js","name":"user","original":{"line":12,"column":22},"generated":{"line":1,"column":796}},{"source":"../routes/register.js","name":"password","original":{"line":13,"column":8},"generated":{"line":1,"column":801}},{"source":"../routes/register.js","name":"Crypto","original":{"line":13,"column":19},"generated":{"line":1,"column":803}},{"source":"../routes/register.js","name":"md5","original":{"line":13,"column":26},"generated":{"line":1,"column":805}},{"source":"../routes/register.js","name":"data","original":{"line":13,"column":30},"generated":{"line":1,"column":809}},{"source":"../routes/register.js","name":"password","original":{"line":13,"column":35},"generated":{"line":1,"column":811}},{"source":"../routes/register.js","name":"passwordConfirm","original":{"line":14,"column":10},"generated":{"line":1,"column":821}},{"source":"../routes/register.js","name":"Crypto","original":{"line":14,"column":28},"generated":{"line":1,"column":823}},{"source":"../routes/register.js","name":"md5","original":{"line":14,"column":35},"generated":{"line":1,"column":825}},{"source":"../routes/register.js","name":"data","original":{"line":14,"column":39},"generated":{"line":1,"column":829}},{"source":"../routes/register.js","original":{"line":14,"column":44},"generated":{"line":1,"column":831}},{"source":"../routes/register.js","name":"email","original":{"line":15,"column":10},"generated":{"line":1,"column":852}},{"source":"../routes/register.js","name":"data","original":{"line":15,"column":18},"generated":{"line":1,"column":854}},{"source":"../routes/register.js","name":"email","original":{"line":15,"column":23},"generated":{"line":1,"column":856}},{"source":"../routes/register.js","name":"toString","original":{"line":15,"column":29},"generated":{"line":1,"column":862}},{"source":"../routes/register.js","name":"password","original":{"line":17,"column":8},"generated":{"line":1,"column":873}},{"source":"../routes/register.js","name":"passwordConfirm","original":{"line":17,"column":21},"generated":{"line":1,"column":877}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":879}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":880}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":882}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":887}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":890}},{"source":"../routes/register.js","name":"res","original":{"line":19,"column":15},"generated":{"line":1,"column":896}},{"source":"../routes/register.js","original":{"line":18,"column":20},"generated":{"line":1,"column":902}},{"source":"../routes/register.js","name":"res","original":{"line":19,"column":15},"generated":{"line":1,"column":922}},{"source":"../routes/register.js","name":"res","original":{"line":19,"column":15},"generated":{"line":1,"column":924}},{"source":"../routes/register.js","name":"res","original":{"line":19,"column":15},"generated":{"line":1,"column":931}},{"source":"../routes/register.js","name":"res","original":{"line":19,"column":15},"generated":{"line":1,"column":940}},{"source":"../routes/register.js","name":"send","original":{"line":19,"column":19},"generated":{"line":1,"column":942}},{"source":"../routes/register.js","name":"Utils","original":{"line":19,"column":24},"generated":{"line":1,"column":947}},{"source":"../routes/register.js","name":"buildResponse","original":{"line":19,"column":30},"generated":{"line":1,"column":949}},{"source":"../routes/register.js","original":{"line":19,"column":44},"generated":{"line":1,"column":964}},{"source":"../routes/register.js","original":{"line":18,"column":20},"generated":{"line":1,"column":966}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":989}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":994}},{"source":"../routes/register.js","name":"email","original":{"line":22,"column":8},"generated":{"line":1,"column":997}},{"source":"../routes/register.js","original":{"line":22,"column":32},"generated":{"line":1,"column":1001}},{"source":"../routes/register.js","name":"email","original":{"line":22,"column":8},"generated":{"line":1,"column":1005}},{"source":"../routes/register.js","name":"indexOf","original":{"line":22,"column":14},"generated":{"line":1,"column":1007}},{"source":"../routes/register.js","original":{"line":22,"column":22},"generated":{"line":1,"column":1015}},{"source":"../routes/register.js","original":{"line":22,"column":61},"generated":{"line":1,"column":1022}},{"source":"../routes/register.js","name":"email","original":{"line":22,"column":37},"generated":{"line":1,"column":1026}},{"source":"../routes/register.js","name":"indexOf","original":{"line":22,"column":43},"generated":{"line":1,"column":1028}},{"source":"../routes/register.js","original":{"line":22,"column":51},"generated":{"line":1,"column":1036}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1041}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1042}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1044}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1049}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1052}},{"source":"../routes/register.js","name":"res","original":{"line":24,"column":15},"generated":{"line":1,"column":1058}},{"source":"../routes/register.js","original":{"line":23,"column":20},"generated":{"line":1,"column":1064}},{"source":"../routes/register.js","name":"res","original":{"line":24,"column":15},"generated":{"line":1,"column":1088}},{"source":"../routes/register.js","name":"res","original":{"line":24,"column":15},"generated":{"line":1,"column":1090}},{"source":"../routes/register.js","name":"res","original":{"line":24,"column":15},"generated":{"line":1,"column":1097}},{"source":"../routes/register.js","name":"res","original":{"line":24,"column":15},"generated":{"line":1,"column":1106}},{"source":"../routes/register.js","name":"send","original":{"line":24,"column":19},"generated":{"line":1,"column":1108}},{"source":"../routes/register.js","name":"Utils","original":{"line":24,"column":24},"generated":{"line":1,"column":1113}},{"source":"../routes/register.js","name":"buildResponse","original":{"line":24,"column":30},"generated":{"line":1,"column":1115}},{"source":"../routes/register.js","original":{"line":24,"column":44},"generated":{"line":1,"column":1130}},{"source":"../routes/register.js","original":{"line":23,"column":20},"generated":{"line":1,"column":1132}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1159}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1164}},{"source":"../routes/register.js","original":{"line":27,"column":18},"generated":{"line":1,"column":1168}},{"source":"../routes/register.js","name":"MidoDb","original":{"line":28,"column":4},"generated":{"line":1,"column":1170}},{"source":"../routes/register.js","name":"init","original":{"line":28,"column":11},"generated":{"line":1,"column":1172}},{"source":"../routes/register.js","original":{"line":28,"column":16},"generated":{"line":1,"column":1177}},{"source":"../routes/register.js","name":"then","original":{"line":29,"column":9},"generated":{"line":1,"column":1188}},{"source":"../routes/register.js","original":{"line":29,"column":14},"generated":{"line":1,"column":1193}},{"source":"../routes/register.js","name":"db","original":{"line":29,"column":14},"generated":{"line":1,"column":1202}},{"source":"../routes/register.js","name":"query","original":{"line":30,"column":18},"generated":{"line":1,"column":1205}},{"source":"../routes/register.js","name":"query","original":{"line":30,"column":18},"generated":{"line":1,"column":1209}},{"source":"../routes/register.js","original":{"line":30,"column":26},"generated":{"line":1,"column":1211}},{"source":"../routes/register.js","name":"user","original":{"line":30,"column":27},"generated":{"line":1,"column":1212}},{"source":"../routes/register.js","name":"user","original":{"line":30,"column":32},"generated":{"line":1,"column":1217}},{"source":"../routes/register.js","name":"email","original":{"line":30,"column":38},"generated":{"line":1,"column":1219}},{"source":"../routes/register.js","name":"email","original":{"line":30,"column":44},"generated":{"line":1,"column":1225}},{"source":"../routes/register.js","name":"password","original":{"line":30,"column":51},"generated":{"line":1,"column":1227}},{"source":"../routes/register.js","name":"password","original":{"line":30,"column":61},"generated":{"line":1,"column":1236}},{"source":"../routes/register.js","name":"MidoDb","original":{"line":31,"column":12},"generated":{"line":1,"column":1239}},{"source":"../routes/register.js","name":"selectRecord","original":{"line":31,"column":19},"generated":{"line":1,"column":1241}},{"source":"../routes/register.js","name":"baseTable","original":{"line":31,"column":32},"generated":{"line":1,"column":1254}},{"source":"../routes/register.js","name":"query","original":{"line":31,"column":43},"generated":{"line":1,"column":1256}},{"source":"../routes/register.js","name":"then","original":{"line":31,"column":50},"generated":{"line":1,"column":1259}},{"source":"../routes/register.js","original":{"line":31,"column":55},"generated":{"line":1,"column":1264}},{"source":"../routes/register.js","name":"record","original":{"line":31,"column":55},"generated":{"line":1,"column":1273}},{"source":"../routes/register.js","name":"record","original":{"line":33,"column":20},"generated":{"line":1,"column":1276}},{"source":"../routes/register.js","name":"console","original":{"line":32,"column":16},"generated":{"line":1,"column":1279}},{"source":"../routes/register.js","name":"log","original":{"line":32,"column":24},"generated":{"line":1,"column":1287}},{"source":"../routes/register.js","name":"record","original":{"line":32,"column":28},"generated":{"line":1,"column":1291}},{"source":"../routes/register.js","name":"record","original":{"line":33,"column":20},"generated":{"line":1,"column":1294}},{"source":"../routes/register.js","name":"length","original":{"line":33,"column":27},"generated":{"line":1,"column":1296}},{"source":"../routes/register.js","name":"record","original":{"line":33,"column":37},"generated":{"line":1,"column":1304}},{"source":"../routes/register.js","name":"length","original":{"line":33,"column":44},"generated":{"line":1,"column":1306}},{"source":"../routes/register.js","original":{"line":33,"column":54},"generated":{"line":1,"column":1314}},{"source":"../routes/register.js","original":{"line":33,"column":57},"generated":{"line":1,"column":1316}},{"source":"../routes/register.js","name":"console","original":{"line":34,"column":20},"generated":{"line":1,"column":1317}},{"source":"../routes/register.js","name":"log","original":{"line":34,"column":28},"generated":{"line":1,"column":1325}},{"source":"../routes/register.js","original":{"line":34,"column":32},"generated":{"line":1,"column":1329}},{"source":"../routes/register.js","name":"res","original":{"line":37,"column":27},"generated":{"line":1,"column":1343}},{"source":"../routes/register.js","name":"MidoDb","original":{"line":36,"column":20},"generated":{"line":1,"column":1350}},{"source":"../routes/register.js","name":"closeDb","original":{"line":36,"column":27},"generated":{"line":1,"column":1352}},{"source":"../routes/register.js","name":"res","original":{"line":37,"column":27},"generated":{"line":1,"column":1362}},{"source":"../routes/register.js","name":"send","original":{"line":37,"column":31},"generated":{"line":1,"column":1364}},{"source":"../routes/register.js","name":"Utils","original":{"line":37,"column":36},"generated":{"line":1,"column":1369}},{"source":"../routes/register.js","name":"buildResponse","original":{"line":37,"column":42},"generated":{"line":1,"column":1371}},{"source":"../routes/register.js","original":{"line":37,"column":56},"generated":{"line":1,"column":1386}},{"source":"../routes/register.js","original":{"line":35,"column":32},"generated":{"line":1,"column":1388}},{"source":"../routes/register.js","name":"MidoDb","original":{"line":42,"column":20},"generated":{"line":1,"column":1457}},{"source":"../routes/register.js","name":"init","original":{"line":42,"column":27},"generated":{"line":1,"column":1459}},{"source":"../routes/register.js","original":{"line":42,"column":32},"generated":{"line":1,"column":1464}},{"source":"../routes/register.js","name":"then","original":{"line":43,"column":25},"generated":{"line":1,"column":1475}},{"source":"../routes/register.js","original":{"line":43,"column":30},"generated":{"line":1,"column":1480}},{"source":"../routes/register.js","name":"db","original":{"line":43,"column":30},"generated":{"line":1,"column":1489}},{"source":"../routes/register.js","name":"insertRecord","original":{"line":45,"column":34},"generated":{"line":1,"column":1492}},{"source":"../routes/register.js","name":"insertRecord","original":{"line":45,"column":34},"generated":{"line":1,"column":1496}},{"source":"../routes/register.js","original":{"line":45,"column":47},"generated":{"line":1,"column":1498}},{"source":"../routes/register.js","name":"user","original":{"line":45,"column":48},"generated":{"line":1,"column":1499}},{"source":"../routes/register.js","name":"user","original":{"line":45,"column":48},"generated":{"line":1,"column":1504}},{"source":"../routes/register.js","name":"email","original":{"line":45,"column":54},"generated":{"line":1,"column":1506}},{"source":"../routes/register.js","name":"email","original":{"line":45,"column":54},"generated":{"line":1,"column":1512}},{"source":"../routes/register.js","name":"password","original":{"line":45,"column":61},"generated":{"line":1,"column":1514}},{"source":"../routes/register.js","name":"password","original":{"line":45,"column":61},"generated":{"line":1,"column":1523}},{"source":"../routes/register.js","name":"status","original":{"line":45,"column":71},"generated":{"line":1,"column":1525}},{"source":"../routes/register.js","original":{"line":45,"column":78},"generated":{"line":1,"column":1532}},{"source":"../routes/register.js","name":"MidoDb","original":{"line":46,"column":28},"generated":{"line":1,"column":1535}},{"source":"../routes/register.js","name":"insertRecord","original":{"line":46,"column":35},"generated":{"line":1,"column":1537}},{"source":"../routes/register.js","name":"insertRecord","original":{"line":46,"column":48},"generated":{"line":1,"column":1550}},{"source":"../routes/register.js","name":"baseTable","original":{"line":46,"column":62},"generated":{"line":1,"column":1552}},{"source":"../routes/register.js","name":"then","original":{"line":46,"column":73},"generated":{"line":1,"column":1555}},{"source":"../routes/register.js","original":{"line":46,"column":78},"generated":{"line":1,"column":1560}},{"source":"../routes/register.js","name":"result","original":{"line":46,"column":78},"generated":{"line":1,"column":1569}},{"source":"../routes/register.js","name":"result","original":{"line":47,"column":35},"generated":{"line":1,"column":1572}},{"source":"../routes/register.js","original":{"line":47,"column":47},"generated":{"line":1,"column":1575}},{"source":"../routes/register.js","name":"result","original":{"line":47,"column":35},"generated":{"line":1,"column":1579}},{"source":"../routes/register.js","name":"ok","original":{"line":47,"column":42},"generated":{"line":1,"column":1581}},{"source":"../routes/register.js","original":{"line":47,"column":51},"generated":{"line":1,"column":1584}},{"source":"../routes/register.js","name":"res","original":{"line":50,"column":43},"generated":{"line":1,"column":1585}},{"source":"../routes/register.js","name":"MidoDb","original":{"line":49,"column":36},"generated":{"line":1,"column":1592}},{"source":"../routes/register.js","name":"closeDb","original":{"line":49,"column":43},"generated":{"line":1,"column":1594}},{"source":"../routes/register.js","name":"res","original":{"line":50,"column":43},"generated":{"line":1,"column":1604}},{"source":"../routes/register.js","name":"send","original":{"line":50,"column":47},"generated":{"line":1,"column":1606}},{"source":"../routes/register.js","name":"Utils","original":{"line":50,"column":52},"generated":{"line":1,"column":1611}},{"source":"../routes/register.js","name":"buildResponse","original":{"line":50,"column":58},"generated":{"line":1,"column":1613}},{"source":"../routes/register.js","original":{"line":50,"column":72},"generated":{"line":1,"column":1628}},{"source":"../routes/register.js","original":{"line":48,"column":48},"generated":{"line":1,"column":1630}},{"source":"../routes/register.js","name":"res","original":{"line":55,"column":39},"generated":{"line":1,"column":1684}},{"source":"../routes/register.js","name":"MidoDb","original":{"line":54,"column":32},"generated":{"line":1,"column":1691}},{"source":"../routes/register.js","name":"closeDb","original":{"line":54,"column":39},"generated":{"line":1,"column":1693}},{"source":"../routes/register.js","name":"res","original":{"line":55,"column":39},"generated":{"line":1,"column":1703}},{"source":"../routes/register.js","name":"send","original":{"line":55,"column":43},"generated":{"line":1,"column":1705}},{"source":"../routes/register.js","name":"Utils","original":{"line":55,"column":48},"generated":{"line":1,"column":1710}},{"source":"../routes/register.js","name":"buildResponse","original":{"line":55,"column":54},"generated":{"line":1,"column":1712}},{"source":"../routes/register.js","original":{"line":55,"column":68},"generated":{"line":1,"column":1727}},{"source":"../routes/register.js","original":{"line":53,"column":44},"generated":{"line":1,"column":1729}},{"source":"../routes/register.js","name":"user","original":{"line":55,"column":79},"generated":{"line":1,"column":1763}},{"source":"../routes/register.js","name":"email","original":{"line":55,"column":85},"generated":{"line":1,"column":1765}},{"source":"../routes/register.js","name":"result","original":{"line":55,"column":92},"generated":{"line":1,"column":1767}},{"source":"../routes/register.js","name":"catch","original":{"line":56,"column":31},"generated":{"line":1,"column":1773}},{"source":"../routes/register.js","original":{"line":56,"column":37},"generated":{"line":1,"column":1779}},{"source":"../routes/register.js","name":"err","original":{"line":56,"column":37},"generated":{"line":1,"column":1788}},{"source":"../routes/register.js","name":"console","original":{"line":56,"column":42},"generated":{"line":1,"column":1791}},{"source":"../routes/register.js","name":"console","original":{"line":56,"column":42},"generated":{"line":1,"column":1798}},{"source":"../routes/register.js","name":"log","original":{"line":56,"column":50},"generated":{"line":1,"column":1806}},{"source":"../routes/register.js","name":"err","original":{"line":56,"column":54},"generated":{"line":1,"column":1810}},{"source":"../routes/register.js","name":"message","original":{"line":56,"column":58},"generated":{"line":1,"column":1812}},{"source":"../routes/register.js","name":"catch","original":{"line":57,"column":27},"generated":{"line":1,"column":1825}},{"source":"../routes/register.js","original":{"line":57,"column":33},"generated":{"line":1,"column":1831}},{"source":"../routes/register.js","name":"err","original":{"line":57,"column":33},"generated":{"line":1,"column":1840}},{"source":"../routes/register.js","name":"console","original":{"line":57,"column":38},"generated":{"line":1,"column":1843}},{"source":"../routes/register.js","name":"console","original":{"line":57,"column":38},"generated":{"line":1,"column":1850}},{"source":"../routes/register.js","name":"log","original":{"line":57,"column":46},"generated":{"line":1,"column":1858}},{"source":"../routes/register.js","name":"err","original":{"line":57,"column":50},"generated":{"line":1,"column":1862}},{"source":"../routes/register.js","name":"message","original":{"line":57,"column":54},"generated":{"line":1,"column":1864}},{"source":"../routes/register.js","name":"catch","original":{"line":60,"column":17},"generated":{"line":1,"column":1877}},{"source":"../routes/register.js","original":{"line":60,"column":23},"generated":{"line":1,"column":1883}},{"source":"../routes/register.js","name":"err","original":{"line":60,"column":23},"generated":{"line":1,"column":1892}},{"source":"../routes/register.js","name":"console","original":{"line":60,"column":28},"generated":{"line":1,"column":1895}},{"source":"../routes/register.js","name":"console","original":{"line":60,"column":28},"generated":{"line":1,"column":1902}},{"source":"../routes/register.js","name":"log","original":{"line":60,"column":36},"generated":{"line":1,"column":1910}},{"source":"../routes/register.js","name":"err","original":{"line":60,"column":40},"generated":{"line":1,"column":1914}},{"source":"../routes/register.js","name":"message","original":{"line":60,"column":44},"generated":{"line":1,"column":1916}},{"source":"../routes/register.js","name":"catch","original":{"line":61,"column":11},"generated":{"line":1,"column":1929}},{"source":"../routes/register.js","original":{"line":61,"column":17},"generated":{"line":1,"column":1935}},{"source":"../routes/register.js","name":"err","original":{"line":61,"column":17},"generated":{"line":1,"column":1944}},{"source":"../routes/register.js","name":"console","original":{"line":61,"column":22},"generated":{"line":1,"column":1947}},{"source":"../routes/register.js","name":"console","original":{"line":61,"column":22},"generated":{"line":1,"column":1954}},{"source":"../routes/register.js","name":"log","original":{"line":61,"column":30},"generated":{"line":1,"column":1962}},{"source":"../routes/register.js","name":"err","original":{"line":61,"column":34},"generated":{"line":1,"column":1966}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1971}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1976}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1979}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1983}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1989}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1996}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":1998}},{"source":"../routes/register.js","original":{"line":5,"column":17},"generated":{"line":1,"column":2007}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2013}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2020}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2029}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2031}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2033}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2036}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2043}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2045}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2051}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2056}},{"source":"../routes/register.js","original":{"line":5,"column":0},"generated":{"line":1,"column":2068}}],"sources":{"../routes/register.js":"const MidoDb = require(\"./../lib/MidoDb\");\r\nconst Crypto = require(\"./../lib/Crypto\");\r\nconst Utils = require(\"./../lib/Utils\");\r\n\r\nmodule.exports = async (req, res, next, baseTable = \"users\") => {\r\n    /* get the params */\r\n    const data = req.query;\r\n\r\n    if (!data || !data.user || !data.password || !data.email || !data['password-confirm'])\r\n        return res.send(Utils.buildResponse(false, \"invalid params\"));\r\n\r\n    const user = data.user;\r\n    let password = Crypto.md5(data.password);\r\n    const passwordConfirm = Crypto.md5(data['password-confirm']);\r\n    const email = data.email.toString();\r\n\r\n    if (password !== passwordConfirm) {\r\n        const msg = \"Password mismatch\";\r\n        return res.send(Utils.buildResponse(false, msg));\r\n    }\r\n\r\n    if (email.indexOf(\"@\") === -1 || email.indexOf(\".\") === -1) {\r\n        const msg = \"Invalid email address\";\r\n        return res.send(Utils.buildResponse(false, msg));\r\n    }\r\n    // attempt to add user to database\r\n    let userFound=false;\r\n    MidoDb.init(\"mongodb\")\r\n        .then(db => {\r\n            const query = {user:user, email:email, password: password};\r\n            MidoDb.selectRecord(baseTable, query).then(record => {\r\n                console.log(record);\r\n                if (record.length && record.length >= 0) {\r\n                    console.log(\"user found\");\r\n                    const msg = \"User already exist. Please use another email address or username\";\r\n                    MidoDb.closeDb();\r\n                    return res.send(Utils.buildResponse(false, msg));\r\n                }\r\n\r\n                if(userFound===false) {\r\n                    // insert our record in the database\r\n                    MidoDb.init(\"mongodb\")\r\n                        .then(db => {\r\n                            // Add this user to the database\r\n                            const insertRecord={user, email, password, status:1};\r\n                            MidoDb.insertRecord(insertRecord, baseTable).then(result=>{\r\n                                if(result.ok!==1)  {\r\n                                    const msg = \"Could not complete registration. Please try again\";\r\n                                    MidoDb.closeDb();\r\n                                    return res.send(Utils.buildResponse(false, msg));\r\n                                }\r\n                                // registration completed\r\n                                const msg = \"Account created. Please wait...\";\r\n                                MidoDb.closeDb();\r\n                                return res.send(Utils.buildResponse(true, msg, user, email, result));\r\n                            }).catch(err=>console.log(err.message));\r\n                        }).catch(err=>console.log(err.message));\r\n                }\r\n            })\r\n                .catch(err=>console.log(err.message));\r\n        }).catch(err=>console.log(err));\r\n}"},"lineCount":null}},"error":null,"hash":"98a15d6b464b59798a0e71cc07ea044a","cacheData":{"env":{}}}